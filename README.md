# marz-backuper

Telegram-бот для автоматического резервного копирования панели Marzban c серверов по SSH. Управление происходит через Telegram, настройка — через YAML-файл.

---

## Возможности

- SSH-подключение к удалённым серверам
- Резервное копирование директорий Marzban (`/opt/marzban`, `/var/lib/marzban`)
- Архивирование в формате `zip` или `tar.gz`
- Отправка архивов в Telegram
- Автоматический запуск бэкапов по расписанию
- Локальное или временное хранение архивов
- Контроль доступа по Telegram ID

---

## Команды бота

| Команда                | Описание                                                                 |
|------------------------|--------------------------------------------------------------------------|
| `/start`               | Приветствие от бота                                                      |
| `/help`                | Список всех доступных команд и логика работы                             |
| `/backup [HH:MM]`      | Немедленный бэкап всех серверов, опционально — установить авто-время     |
| `/send_backup <IP>`    | Резервная копия конкретного сервера по IP                                |
| `/list_backups`        | Список локально сохранённых архивов (если включено хранение)             |
| `/clear_backups`       | Удалить все локальные архивы                                             |
| `/status`              | Текущий статус: оставшиеся архивы, формат, хранение, след. запуск        |

---

## Принцип работы

1. Подключение к каждому серверу по SSH с логином/паролем.
2. Скачивание директорий Marzban (`/var/lib/marzban`, `/opt/marzban`).
3. Упаковка содержимого в архив (`.zip` или `.tar.gz`).
4. Отправка архива в Telegram.
5. Если включено `local: true`, архив сохраняется в `tmp/`; иначе — удаляется.
6. Планировщик APScheduler запускает авто-бэкапы по времени из конфига.

---

## Установка

### Шаг 1: Клонируй проект

git clone https://github.com/sterjs/marz-backuper.git
cd marz-backuper


### Шаг 2: Виртуальное окружение

python3 -m venv venv
source venv/bin/activate


### Шаг 3: Установка зависимостей

pip install -r requirements.txt


### Шаг 4: Настрой конфигурацию

Открой и отредактируй `config.yml`:
nano config.yml

### Шаг 5: Запуск

python main.py


---

## Автор

**Разработка:** [@stix_r](https://t.me/stix_r)  
**Репозиторий:** [github.com/sterjs/marz-backuper](https://github.com/sterjs/marz-backuper)

---

**Marz-Backuper** — простой и безопасный способ автоматического копирования вашей панели Marzban.
